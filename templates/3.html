{% extends 'base.html' %}
{% block main_content %}

<div class="container cen" >
    <div class="row">
        <div class="col-md-3 col-lg-2 mb-4 tablo">
            <h5>Фильтр</h5>
            <div>
                <label for="difficultySelect">Выбор сложности:</label>
                <select id="difficultySelect" onchange="filterTasks()">
                    <option value="">Все</option>
                    <option value="Легкий">Легкий</option>
                    <option value="Средний">Средний</option>
                    <option value="Сложный">Сложный</option>
                </select>
            </div>
            <div>
                <label for="taskNumberSelect">Выбор номера задания:</label>
                <select id="taskNumberSelect" onchange="filterTasks()">
                    <option value="">Все</option>
                    {% for i in tasks %}
                        <option value="{{i['type']}}">Задание {{i['type']}}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="col-md-9">
            {% for i in tasks %}
                <main class="container mt-5 p-5 tablo task-item" data-difficulty="{{i['level']}}" data-id="{{i['id']}}">
                    <h4>
                        Задание {{i["type"]}}
                    </h4>
                    <h6>id-задания {{i["id"]}}</h6>

                    <div class="small-br"></div>

                    <b><i>Сложность: {{i["level"]}}</i></b>
                    <div class="small-br"></div>

                    <div>Условие:</div>
                    <p class="text-task">{{i['text']|safe }} </p>

                    <div style="display: flex; align-items: center;">
                        <button class="button btn-answer btn-violet" id="toggleButton-{{i['id']}}" onclick="toggleAnswer('{{i['id']}}')">Показать ответ</button>
                        <div class="answer" id="answer-{{i['id']}}" style="display: none; margin-left: 10px;">
                            <div class="custom-box">
                                {{i['ans']|safe}}
                            </div>
                        </div>
                    </div>
                </main>
            {% endfor %}
        </div>
    </div>

    <br>

    <script>
        function toggleAnswer(id) {
            const answer = document.getElementById(`answer-${id}`);
            const toggleButton = document.getElementById(`toggleButton-${id}`);

            if (answer.style.display === 'none' || answer.style.display === '') {
                answer.style.display = 'block';
                toggleButton.textContent = 'Скрыть ответ';
            } else {
                answer.style.display = 'none';
                toggleButton.textContent = 'Показать ответ';
            }
        }

        function filterTasks() {
            const difficultySelect = document.getElementById('difficultySelect');
            const taskNumberSelect = document.getElementById('taskNumberSelect');
            const selectedDifficulty = difficultySelect.value;
            const selectedTaskNumber = taskNumberSelect.value;

            const tasks = document.querySelectorAll('.task-item');

            tasks.forEach(task => {
                const taskDifficulty = task.getAttribute('data-difficulty');
                const taskId = task.getAttribute('data-id');

                const matchesDifficulty = selectedDifficulty === '' || taskDifficulty === selectedDifficulty;
                const matchesTaskNumber = selectedTaskNumber === '' || taskId === selectedTaskNumber;

                task.style.display = matchesDifficulty && matchesTaskNumber ? '' : 'none';
            });
        }
    </script>
</div>

<style>
    @media (max-width: 768px) {
        .filter-container {
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }
    }
</style>

{% endblock %}
